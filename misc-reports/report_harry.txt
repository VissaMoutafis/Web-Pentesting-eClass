
> Ανταλλαγή αρχείων

XSS
---
Persistent (αποθηκεύεται στη βάση):
* Αποστολέας (είναι Custom/User input for some reason)
* Περιγραφή αρχείου
* (?) Τίτλος αρχείου

Defence:

/openeclass/modules/dropbox/index.php: htmlspecialchars σε 1) συγγραφέα 2) περιγραφή 3) τίτλο
/openeclass/modules/dropbox/submit.php: htmlspecialchars στον τίτλο αρχείου

RFI
---
.php / .html file submission
  -> Ανεβάζοντας ένα .php / .html αρχείο αποθηκεύεται σε directory με 777 (public) (http://localhost:8001/courses/TMA100/dropbox/)
     permissions οπότε ο οποιοσδήποτε μπορεί να το τρέξει (ή να στείλει malicious link σε άλλον) 

Defence:

/openeclass/modules/dropbox/submit.php: htmlspecialchars στον τίτλο αρχείου, μετατροπή .php/.html/.js αρχείων σε .phps/htmls/javasc

TODO: Check permissions (?) (Ίσως not-needed εφόσον δεν μπορούν να τρέξουν αρχεία;)


Broken authentication
---------------------
* http://localhost:8001/modules/dropbox/dropbox_download.php?id=5
  -> User can customize ID and view/download messages between other users 



> Εργασίες

SQLi
-----
* http://localhost:8001/modules/work/work.php?id= 
  TODO : Find a payload to exploit it

Defence: fixed with "is_numeric" below (XSS def aswell)

XSS
---
Temporary: (αν και αποθηκεύεται στα logs)
* http://localhost:8001/modules/work/work.php?id='--<script>alert(1);</script>

Defence:
/openeclass/modules/work/work.php: Verify that $id is numeric with "is_numeric($id)"


Persistent (αποθηκεύεται στη βάση):
* Σχόλια εργασίας
* (?) Τίτλος αρχείου

Defence:

/openeclass/modules/work/work.php & work_functions.php : htmlspecialchars σε 1) σχόλια (student και professor) 2) περιγραφή 3) τίτλο αρχείου


Admin:

openeclass/modules/work/work.php : Γραμμές 133-200 είναι XSS (temp) prone με όλα τα πεδία που έρχονται από το URL

Defence: 1) is_numeric όπου αναμένεται int
         2) sanitized text (δηλαδή όπου αναμένονται grade comments)


RFI
---

.php / .html file submission
  -> Ανεβάζοντας ένα .php / .html αρχείο αποθηκεύεται σε directory με 777 (public) (http://localhost:8001/courses/TMA100/work/)
     permissions οπότε ο οποιοσδήποτε μπορεί να το τρέξει (ή να στείλει malicious link σε άλλον) 

Defence: /openeclass/modules/work/work.php: Mετατροπή .php/.html/.js αρχείων σε .phps/htmls/javasc


Broken access control
---------------------
* http://localhost:8001/modules/work/work.php?id=2
  -> User can customize ID and view hidden assignments (or submit for assignments that
     don't exist [yet])


**ADMIN** (/modules/admin/)
----------------------------

SQLi:

Αναζήτηση χρήστη (http://localhost:8001/modules/admin/search_user.php) (όλα τα πεδία)

XSS:

Ανακοινώσεις διαχειριστή: (http://localhost:8001/modules/admin/adminannouncements.php)
Def: htmlcharacters ό,τι μπορούσα αλλά αυτό είναι προβληματικό:
http://localhost:8001/modules/admin/adminannouncements.php?modify=1&contentToModify=%3Cscript%3Ealert(1)%3C/script%3E&localize=el

1) Input στις φόρμες 
Def: htmlspecialchars όταν *αποθηκεύεται* στη βάση

2) με ?message πεδίο: http://localhost:8001/modules/admin/adminannouncements.php?message=%3Cscript%3E%20alert(%27oops%27)%20%3C/script%3E
Def: htmlspecialchars στο $message

Δημιουργία μαθήματος: (http://localhost:8001/modules/create_course/create_course.php)


Οbscure XSS + CSRF Point of entry:
http://localhost:8001/modules/units/info.php


! KALO ATTACK !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!Broken authentication
!---------------------
!* http://localhost:8001/modules/dropbox/dropbox_download.php?id=5
!  -> User can customize ID and view/download messages between other users 
!
! Αν ο χρήστης ανεβάσει malicious html αρχείο και δεν το έχουν προβλέψει,
! μπορούμε απλά να στείλουμε το λινκ με το id και το html αρχείο θα τρέξει
! στον browser (μαζί με τα <script> αν δεν έχουν nonce-protection) όποιου το ανοίξει, 
! λογικά με τα cookies του εφόσον είναι στο ίδιο top-domain
!!!!!!!!!!!!!!!!!!!!!!!!!!!!
